---
phase: 38-macos-accessibility
plan: 03
type: execute
wave: 3
depends_on: [38-02]
files_modified:
  - examples/accessibility_check.v
  - accessibility/backend_stub.v
autonomous: true
must_haves:
  truths:
    - "Code compiles on non-macOS platforms (stub check)"
    - "Example application runs and initializes accessibility"
  artifacts:
    - path: examples/accessibility_check.v
      contains: "accessibility.new_manager"
  key_links: []
---

<objective>
Verify the accessibility implementation with a runnable example and ensure cross-platform compatibility.

Purpose: Confirm no regressions for other platforms and provide a testing tool for macOS.
Output: `examples/accessibility_check.v` and verified stubs.
</objective>

<execution_context>
@/Users/mike/.gemini/get-shit-done/workflows/execute-plan.md
@/Users/mike/.gemini/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/38-macos-accessibility/38-02-SUMMARY.md
@accessibility/backend_stub.v
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Verification Example</name>
  <files>examples/accessibility_check.v</files>
  <action>
    Create `examples/accessibility_check.v`:
    - Initialize `gg` and `accessibility` manager.
    - Create a simple UI with:
      - A static label ("Hello Accessibility").
      - A text field (simulated).
    - Call `accessibility.update_tree` every frame (or periodically).
    - Allow cycling focus with Tab.
    - Print to stdout when accessibility methods are called (if possible/visible).
    - *Goal*: A minimal app that triggers the `DarwinAccessibilityBackend` code paths.
  </action>
  <verify>
    Run `v run examples/accessibility_check.v`.
  </verify>
  <done>
    Example runs without crashing.
  </done>
</task>

<task type="auto">
  <name>Task 2: Verify Cross-Platform Compilation</name>
  <files>accessibility/backend_stub.v</files>
  <action>
    1. Check `accessibility/backend_stub.v` to ensure it implements the full interface defined in `backend_darwin.v` (checking signatures).
    2. *Self-Correction*: I previously checked `backend_stub.v` and it looked complete. This task is a final safety check.
    3. If any new methods were added to `DarwinAccessibilityBackend` (none planned), add them to Stub.
  </action>
  <verify>
    Simulate linux build if possible, or just visual verification of function signatures matching.
  </verify>
  <done>
    Stub matches interface.
  </done>
</task>

</tasks>

<verification>
Run the example on macOS.
Check that Accessibility Inspector shows the elements (manual verification by user later, but we ensure code runs).
</verification>

<success_criteria>
- Example runs.
- Stubs are consistent.
</success_criteria>

<output>
After completion, create `.planning/phases/38-macos-accessibility/38-03-SUMMARY.md`
</output>
