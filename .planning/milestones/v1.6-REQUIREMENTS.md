# Requirements Archive: v1.6 Performance Optimization

**Archived:** 2026-02-05
**Status:** SHIPPED

This is the archived requirements specification for v1.6.
For current requirements, see `.planning/REQUIREMENTS.md` (created for next milestone).

---

# Requirements: VGlyph v1.6 Performance Optimization

**Defined:** 2026-02-04
**Core Value:** Reliable text rendering without crashes or undefined behavior

## v1.6 Requirements

Requirements for performance optimization milestone. Each maps to roadmap phases.

### Atlas Optimization

- [x] **ATLAS-01**: Shelf packing allocator with best-height-fit algorithm
- [x] **ATLAS-02**: Per-row shelf tracking for atlas pages
- [x] **ATLAS-03**: Preserve existing page-level LRU eviction behavior

### GPU Pipeline

- [x] **GPU-01**: Double-buffered pixel staging for texture uploads
- [x] **GPU-02**: CPU/GPU overlap during glyph rasterization
- [x] **GPU-03**: Preserve commit() -> draw ordering

### Profiling

- [x] **PROF-01**: LayoutCache hit rate measurement (before shape cache decision)
- [x] **PROF-02**: Atlas utilization metrics (validate shelf packing improvement)

### Shape Caching (Conditional)

- [x] **SHAPE-01**: HarfBuzz shape plan caching â€” SKIPPED (LayoutCache 92.3% > 70%)

## Future Requirements

Deferred to post-v1.6. Tracked but not in current roadmap.

### Advanced Atlas

- **ATLAS-04**: Multiple shelf height bins (small/medium/large glyphs)
- **ATLAS-05**: Per-page staging buffers

### Advanced Profiling

- **PROF-03**: Upload time breakdown metrics
- **PROF-04**: Shape cache hit rate tracking

## Out of Scope

Explicitly excluded. Documented to prevent scope creep.

| Feature | Reason |
|---------|--------|
| Runtime defragmentation | Causes frame stalls, not suitable for real-time rendering |
| Guillotine cutting | Overcomplicated for text atlases, shelf packing sufficient |
| Multi-threaded uploads | V is single-threaded by design |
| PBO complexity | Sokol abstracts this, double-buffering sufficient |
| Thread-safe caching | Not needed for single-threaded design |

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| ATLAS-01 | Phase 26 | Complete |
| ATLAS-02 | Phase 26 | Complete |
| ATLAS-03 | Phase 26 | Complete |
| GPU-01 | Phase 27 | Complete |
| GPU-02 | Phase 27 | Complete |
| GPU-03 | Phase 27 | Complete |
| PROF-01 | Phase 28 | Complete |
| PROF-02 | Phase 28 | Complete |
| SHAPE-01 | Phase 29 | Skipped |

**Coverage:**
- v1.6 requirements: 9 total
- Completed: 8
- Skipped: 1 (data-driven decision)
- Unmapped: 0

---

## Milestone Summary

**Shipped:** 8 of 9 v1.6 requirements
**Adjusted:** SHAPE-01 changed from conditional to skipped based on profiling data
**Dropped:** None

---
*Archived: 2026-02-05 as part of v1.6 milestone completion*
