# Requirements Archive: v1.3 Text Editing

**Archived:** 2026-02-03
**Status:** SHIPPED (26/29 requirements, 3 blocked by external architecture)

This is the archived requirements specification for v1.3.
For current requirements, see `.planning/REQUIREMENTS.md` (created for next milestone).

---

## v1.3 Requirements

Requirements for text editing milestone. Each maps to roadmap phases.

### Cursor

- [x] **CURS-01**: User can click to position cursor at character boundary
- [x] **CURS-02**: Cursor position returns geometry (x, y, height) for rendering
- [x] **CURS-03**: Arrow keys move cursor by character, word (Cmd+Arrow), or line
- [x] **CURS-04**: Home/End keys move cursor to line start/end
- [x] **CURS-05**: Cursor movement respects grapheme clusters (emoji, combining marks)

### Selection

- [x] **SEL-01**: User can click+drag to select text range
- [x] **SEL-02**: Shift+arrow extends selection from cursor
- [x] **SEL-03**: Double-click selects word, triple-click selects line
- [x] **SEL-04**: Cmd+A selects all text
- [x] **SEL-05**: Selection returns geometry rects for highlighting

### Mutation

- [x] **MUT-01**: User can insert text at cursor position
- [x] **MUT-02**: Backspace deletes character before cursor (or selection)
- [x] **MUT-03**: Delete key removes character after cursor (or selection)
- [x] **MUT-04**: Cut (Cmd+X) removes selection to clipboard
- [x] **MUT-05**: Copy (Cmd+C) copies selection to clipboard
- [x] **MUT-06**: Paste (Cmd+V) inserts clipboard at cursor (replacing selection)

### Undo/Redo

- [x] **UNDO-01**: Cmd+Z undoes last edit operation
- [x] **UNDO-02**: Cmd+Shift+Z redoes last undone operation
- [x] **UNDO-03**: Undo history limited to 50-100 actions

### IME (macOS)

- [ ] **IME-01**: NSTextInputClient protocol integration for macOS IME *(blocked: sokol)*
- [ ] **IME-02**: Composition text displayed with underline (preedit) *(blocked: sokol)*
- [ ] **IME-03**: Candidate window positions near cursor *(blocked: sokol)*
- [x] **IME-04**: Dead keys compose characters (e.g., ` + e = e)

### API & Demo

- [x] **API-01**: Editing API documented with examples for all operations
- [x] **API-02**: Demo application demonstrates cursor, selection, mutation, undo
- [x] **API-03**: Demo exercises IME composition (Japanese input test) *(dead keys only, CJK blocked)*

### Accessibility

- [x] **ACC-01**: VoiceOver announces cursor position changes
- [x] **ACC-02**: VoiceOver announces selection changes
- [x] **ACC-03**: IME composition state accessible to VoiceOver

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| CURS-01 | Phase 11 | Complete |
| CURS-02 | Phase 11 | Complete |
| CURS-03 | Phase 11 | Complete |
| CURS-04 | Phase 11 | Complete |
| CURS-05 | Phase 11 | Complete |
| SEL-01 | Phase 12 | Complete |
| SEL-02 | Phase 12 | Complete |
| SEL-03 | Phase 12 | Complete |
| SEL-04 | Phase 12 | Complete |
| SEL-05 | Phase 12 | Complete |
| MUT-01 | Phase 13 | Complete |
| MUT-02 | Phase 13 | Complete |
| MUT-03 | Phase 13 | Complete |
| MUT-04 | Phase 13 | Complete |
| MUT-05 | Phase 13 | Complete |
| MUT-06 | Phase 13 | Complete |
| UNDO-01 | Phase 14 | Complete |
| UNDO-02 | Phase 14 | Complete |
| UNDO-03 | Phase 14 | Complete |
| IME-01 | Phase 15 | Blocked (sokol) |
| IME-02 | Phase 15 | Blocked (sokol) |
| IME-03 | Phase 15 | Blocked (sokol) |
| IME-04 | Phase 15 | Complete |
| API-01 | Phase 16 | Complete |
| API-02 | Phase 16 | Complete |
| API-03 | Phase 16 | Complete |
| ACC-01 | Phase 17 | Complete |
| ACC-02 | Phase 17 | Complete |
| ACC-03 | Phase 17 | Complete |

---

## Milestone Summary

**Shipped:** 26 of 29 requirements
**Blocked:** 3 (IME-01, IME-02, IME-03 â€” sokol architecture limitation)
**Adjusted:** None
**Dropped:** None

### Blocked Requirements Detail

IME-01, IME-02, IME-03 require NSTextInputClient protocol integration. The native bridge
was implemented correctly in `ime_bridge_macos.m`, but sokol creates an MTKView internally
that cannot be subclassed. NSView categories don't affect MTKView behavior.

**Future resolution options:**
1. Fork sokol and add NSTextInputClient support
2. Create overlay NSView for text input
3. Method swizzling (not recommended)

Dead key composition (IME-04) works without the native bridge because it uses standard
keyboard character events.

---
*Archived: 2026-02-03 as part of v1.3 milestone completion*
